management:
  endpoints:
    web:
      exposure:
        include: health,info,prometheus
  metrics:
    export:
      prometheus:
        enabled: true
  endpoint:
    health:
      show-details: always
      show-components: always
      status:
        http-mapping:
          down: 503
          out-of-service: 503
          up: 200
          unknown: 200
  health:
    db:
      enabled: true
    redis:
      enabled: true
    diskspace:
      enabled: true
  info:
    env:
      enabled: true
spring:
  application:
    name: portfolio
  docker:
    compose:
      enabled: true
      file: ./compose.yaml
  jackson:
    default-property-inclusion: non_null
  datasource:
    url: ${SPRING_DATASOURCE_URL:jdbc:postgresql://postgres:5432/portfolio}
    username: ${SPRING_DATASOURCE_USERNAME:postgres}
    password: ${SPRING_DATASOURCE_PASSWORD:postgres}
    driver-class-name: org.postgresql.Driver
    hikari:
      maximum-pool-size: 10
      minimum-idle: 5
      connection-timeout: 20000
      leak-detection-threshold: 180000
  jpa:
    hibernate:
      ddl-auto: none # Use 'update' for development
    show-sql: false
    database: POSTGRESQL
    database-platform: org.hibernate.dialect.PostgreSQLDialect
    properties:
      hibernate:
        format_sql: false
        temp.use_jdbc_metadata_defaults: false
        id.new_generator_mappings: true
        cache.use_second_level_cache: false
        cache.use_query_cache: false
        generate_statistics: false

  flyway:
    url: ${spring.datasource.url}
    user: ${spring.datasource.username}
    password: ${spring.datasource.password}
    enabled: true
    baseline-on-migrate: true

  data:
    redis:
      host: redis
      port: 6379
      repositories:
        enabled: false

  task:
    scheduling:
      pool:
        size: 10
      thread-name-prefix: scheduled-
    execution:
      pool:
        core-size: 10
        max-size: 20
        queue-capacity: 100

logging:
  level:
    root: INFO
    org.springframework: INFO
    org.hibernate: INFO
    ee.tenman.portfolio.service.EtfHoldingsService: DEBUG
    ee.tenman.portfolio.service.HoldingParser: DEBUG
  pattern:
    console: '%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{20} %X{transactionId}- %msg%n'
#    console: '%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg %X{traceId}%n'
    file: '%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{20} %X{transactionId}- %msg%n'

server:
  port: ${SERVER_PORT:8081}

springdoc:
  api-docs:
    path: /api-docs
  swagger-ui:
    path: /swagger-ui.html
    operationsSorter: method

binance:
  url: https://api.binance.com

auth:
  url: http://auth:8083

feign:
  client:
    config:
      default:
        loggerLevel: FULL

historicalPrices:
  url: https://markets.ft.com

ft:
  job:
    enabled: true
  parallel:
    threads: 5
  instruments:
    parallel:
      threads: 5
  adaptive-scheduling:
    enabled: ${FT_ADAPTIVE_SCHEDULING_ENABLED:false}
    minimum-interval-seconds: 60

vision:
  enabled: ${VISION_ENABLED:false}
  base64EncodedKey: ${VISION_BASE64_ENCODED_KEY:}

telegram:
  bot:
    enabled: ${TELEGRAM_BOT_ENABLED:false}
    token: ${TELEGRAM_BOT_TOKEN:}

minio:
  endpoint: ${MINIO_ENDPOINT:http://localhost:9000}
  access-key: ${MINIO_ACCESS_KEY:minioadmin}
  secret-key: ${MINIO_SECRET_KEY:minioadmin}
  bucket-name: ${MINIO_BUCKET_NAME:portfolio-logos}

build:
  hash: ${BUILD_HASH:unknown}
  time: ${BUILD_TIME:unknown}

scheduling:
  enabled: ${SCHEDULING_ENABLED:true}
  jobs:
    binance-interval: ${BINANCE_JOB_INTERVAL:120000}
    ft-interval: ${FT_JOB_INTERVAL:120000}
    xirr-interval: ${XIRR_JOB_INTERVAL:120000}
    summary-interval: ${SUMMARY_JOB_INTERVAL:120000}
    trading212-interval: ${TRADING212_JOB_INTERVAL:60000}
    industry-classification: ${INDUSTRY_CLASSIFICATION_CRON:0 0 2 * * *}
    etf-holdings-classification-cron: ${ETF_HOLDINGS_CLASSIFICATION_CRON:0 0 3 * * *}
    ecb-cron: ${ECB_JOB_CRON:0 0 9 * * *}

scraping:
  lightyear:
    etfs:
      - symbol: "VUAA:GER:EUR"
        uuid: "1eda4008-c9e6-6bde-b60a-654bcfbd8ac3"
      - symbol: "QDVE:GER:EUR"
        uuid: "1ef27f9a-bde6-6dda-a873-3946ca86bd5c"
      - symbol: "XAIX:GER:EUR"
        uuid: "1ef66ace-af0a-6d81-ab3f-c9f7567377e0"
      - symbol: "SPYL:GER:EUR"
        uuid: "1ef66aa4-5a18-65da-ab3f-c9f7567377e0"
      - symbol: "CSX5:AEX:EUR"
        uuid: "1ecf2dbe-e840-6165-8df4-d975f6a704cf"
      - symbol: "VNRT:AEX:EUR"
        uuid: "1ecf2da3-e426-68b7-a268-3d0ec5cf88ad"
      - symbol: "VWCE:GER:EUR"
        uuid: "1eda0a07-10b3-63e0-b568-6deedaa217e7"
      - symbol: "SPPW:GER:EUR"
        uuid: "1ef56330-1354-62df-99c7-5dccd8043f1d"
      - symbol: "VNRA:GER:EUR"
        uuid: "1eda4008-ca17-6926-b60a-654bcfbd8ac3"
      - symbol: "XNAS:GER:EUR"
        uuid: "1f098996-8150-6170-8254-e77b526cb347"
    additional-instruments:
      - symbol: "WTAI:MIL:EUR"
        uuid: "1f02fdcc-38f9-67b8-ad1b-a71ae2564bd4"
      - symbol: "WBIT:GER:EUR"
        uuid: "1ef3aa4c-5f26-6cf0-8eba-bb4404220dad"

cloudflare-bypass-proxy:
  url: ${CLOUDFLARE_BYPASS_PROXY_URL:${TRADING212_PROXY_URL:http://localhost:3000}}

trading212:
  proxy:
    url: ${TRADING212_PROXY_URL:${cloudflare-bypass-proxy.url}}
  batch-size: ${TRADING212_BATCH_SIZE:15}



openrouter:
  api-key: ${OPENROUTER_API_KEY}
  circuit-breaker:
    failure-threshold: 3
    recovery-timeout-seconds: 60

industry-classification:
  enabled: true

ecb:
  url: https://data-api.ecb.europa.eu

veego:
  url: https://api.veego.ee/api
