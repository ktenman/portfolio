<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1676px" preserveAspectRatio="none" style="width:1715px;height:1676px;background:#FFFFFF;" version="1.1" viewBox="0 0 1715 1676" width="1715px" zoomAndPan="magnify"><title>XIRR Calculation Flow - Daily Portfolio Summary</title><defs/><g><text fill="#000000" font-family="Verdana" font-size="22" font-weight="bold" lengthAdjust="spacing" textLength="601.5195" x="557.8818" y="37.1182">XIRR Calculation Flow - Daily Portfolio Summary</text><rect fill="#FFFFFF" height="1536.269" style="stroke:#000000;stroke-width:1;" width="10" x="56.9009" y="94.752"/><rect fill="#FFFFFF" height="1184.8813" style="stroke:#000000;stroke-width:1;" width="10" x="214.5679" y="132.3506"/><rect fill="#FFFFFF" height="75.3979" style="stroke:#000000;stroke-width:1;" width="10" x="478.7783" y="162.1499"/><rect fill="#FFFFFF" height="75.3979" style="stroke:#000000;stroke-width:1;" width="10" x="686.7568" y="350.3145"/><rect fill="#FFFFFF" height="371.1611" style="stroke:#000000;stroke-width:1;" width="10" x="686.7568" y="666.1069"/><rect fill="#FFFFFF" height="537.957" style="stroke:#000000;stroke-width:1;" width="10" x="918.3594" y="581.709"/><rect fill="#FFFFFF" height="478.3584" style="stroke:#000000;stroke-width:1;" width="10" x="1187.9653" y="611.5083"/><rect fill="#FFFFFF" height="1057.6841" style="stroke:#000000;stroke-width:1;" width="1429.0742" x="101.4878" y="252.5479"/><rect fill="#FFFFFF" height="997.0854" style="stroke:none;stroke-width:1;" width="1429.0742" x="101.4878" y="313.1465"/><rect fill="#FFFFFF" height="761.1216" style="stroke:#000000;stroke-width:1;" width="1409.0742" x="111.4878" y="542.1104"/><rect fill="#FFFFFF" height="418.7598" style="stroke:#000000;stroke-width:1;" width="1120.3965" x="390.1655" y="626.5083"/><rect fill="#FFFFFF" height="92.7666" style="stroke:#000000;stroke-width:1;" width="776.2627" x="604.7681" y="915.7021"/><rect fill="#FFFFFF" height="45.168" style="stroke:none;stroke-width:1;" width="776.2627" x="604.7681" y="963.3008"/><rect fill="#FFFFFF" height="60.5986" style="stroke:#000000;stroke-width:1;" width="361.9414" x="121.4878" y="1177.4653"/><rect fill="#FFFFFF" height="58.168" style="stroke:none;stroke-width:1;" width="1409.0742" x="111.4878" y="1245.064"/><line style="stroke:#000000;stroke-width:1;" x1="61" x2="61" y1="84.752" y2="1640.021"/><line style="stroke:#000000;stroke-width:1;" x1="219.4878" x2="219.4878" y1="84.752" y2="1640.021"/><line style="stroke:#000000;stroke-width:1;" x1="483.1655" x2="483.1655" y1="84.752" y2="1640.021"/><line style="stroke:#000000;stroke-width:1;" x1="690.7681" x2="690.7681" y1="84.752" y2="1640.021"/><line style="stroke:#000000;stroke-width:1;" x1="922.9648" x2="922.9648" y1="84.752" y2="1640.021"/><line style="stroke:#000000;stroke-width:1;" x1="1192.7847" x2="1192.7847" y1="84.752" y2="1640.021"/><line style="stroke:#000000;stroke-width:1;" x1="1320.146" x2="1320.146" y1="84.752" y2="1640.021"/><line style="stroke:#000000;stroke-width:1;" x1="1440.0308" x2="1440.0308" y1="84.752" y2="1640.021"/><rect fill="#FFFFFF" height="31.0146" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="83.8018" x="20" y="52.7373"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="69.8018" x="27" y="73.8125">Scheduler</text><rect fill="#FFFFFF" height="31.0146" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="83.8018" x="20" y="1639.021"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="69.8018" x="27" y="1660.0962">Scheduler</text><rect fill="#FFFFFF" height="31.0146" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="156.1602" x="141.4878" y="52.7373"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="142.1602" x="148.4878" y="73.8125">DailyPortfolioXirrJob</text><rect fill="#FFFFFF" height="31.0146" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="156.1602" x="141.4878" y="1639.021"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="142.1602" x="148.4878" y="1660.0962">DailyPortfolioXirrJob</text><rect fill="#FFFFFF" height="31.0146" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="147.2256" x="410.1655" y="52.7373"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="133.2256" x="417.1655" y="73.8125">TransactionService</text><rect fill="#FFFFFF" height="31.0146" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="147.2256" x="410.1655" y="1639.021"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="133.2256" x="417.1655" y="1660.0962">TransactionService</text><rect fill="#FFFFFF" height="31.0146" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="133.9775" x="624.7681" y="52.7373"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="119.9775" x="631.7681" y="73.8125">SummaryService</text><rect fill="#FFFFFF" height="31.0146" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="133.9775" x="624.7681" y="1639.021"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="119.9775" x="631.7681" y="1660.0962">SummaryService</text><rect fill="#FFFFFF" height="31.0146" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="142.7891" x="851.9648" y="52.7373"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="128.7891" x="858.9648" y="73.8125">CalculationService</text><rect fill="#FFFFFF" height="31.0146" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="142.7891" x="851.9648" y="1639.021"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="128.7891" x="858.9648" y="1660.0962">CalculationService</text><rect fill="#FFFFFF" height="31.0146" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="116.3613" x="1134.7847" y="52.7373"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="102.3613" x="1141.7847" y="73.8125">Coroutine Pool</text><rect fill="#FFFFFF" height="31.0146" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="116.3613" x="1134.7847" y="1639.021"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="102.3613" x="1141.7847" y="1660.0962">Coroutine Pool</text><rect fill="#FFFFFF" height="31.0146" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="79.8848" x="1281.146" y="52.7373"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="65.8848" x="1288.146" y="73.8125">Database</text><rect fill="#FFFFFF" height="31.0146" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="79.8848" x="1281.146" y="1639.021"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="65.8848" x="1288.146" y="1660.0962">Database</text><rect fill="#FFFFFF" height="31.0146" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="99.5313" x="1391.0308" y="52.7373"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="85.5313" x="1398.0308" y="73.8125">Redis Cache</text><rect fill="#FFFFFF" height="31.0146" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:1;" width="99.5313" x="1391.0308" y="1639.021"/><text fill="#000000" font-family="Verdana" font-size="14" lengthAdjust="spacing" textLength="85.5313" x="1398.0308" y="1660.0962">Redis Cache</text><rect fill="#FFFFFF" height="1536.269" style="stroke:#000000;stroke-width:1;" width="10" x="56.9009" y="94.752"/><rect fill="#FFFFFF" height="1184.8813" style="stroke:#000000;stroke-width:1;" width="10" x="214.5679" y="132.3506"/><rect fill="#FFFFFF" height="75.3979" style="stroke:#000000;stroke-width:1;" width="10" x="478.7783" y="162.1499"/><rect fill="#FFFFFF" height="75.3979" style="stroke:#000000;stroke-width:1;" width="10" x="686.7568" y="350.3145"/><rect fill="#FFFFFF" height="371.1611" style="stroke:#000000;stroke-width:1;" width="10" x="686.7568" y="666.1069"/><rect fill="#FFFFFF" height="537.957" style="stroke:#000000;stroke-width:1;" width="10" x="918.3594" y="581.709"/><rect fill="#FFFFFF" height="478.3584" style="stroke:#000000;stroke-width:1;" width="10" x="1187.9653" y="611.5083"/><polygon fill="#000000" points="202.5679,128.3506,212.5679,132.3506,202.5679,136.3506,206.5679,132.3506" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="66.9009" x2="208.5679" y1="132.3506" y2="132.3506"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="128.667" x="73.9009" y="111.8218">@Scheduled trigger</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="119.7231" x="73.9009" y="127.6211">(daily at 6:30 AM)</text><polygon fill="#000000" points="466.7783,158.1499,476.7783,162.1499,466.7783,166.1499,470.7783,162.1499" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="224.5679" x2="472.7783" y1="162.1499" y2="162.1499"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="131.3203" x="231.5679" y="157.4204">getAllTransactions()</text><polygon fill="#000000" points="1309.0884,203.7485,1319.0884,207.7485,1309.0884,211.7485,1313.0884,207.7485" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="488.7783" x2="1315.0884" y1="207.7485" y2="207.7485"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="244.6006" x="495.7783" y="187.2197">SELECT * FROM portfolio_transaction</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="203.4678" x="495.7783" y="203.019">ORDER BY transaction_date, id</text><polygon fill="#000000" points="494.7783,233.5479,484.7783,237.5479,494.7783,241.5479,490.7783,237.5479" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="488.7783" x2="1320.0884" y1="237.5479" y2="237.5479"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="79.6377" x="500.7783" y="232.8184">transactions</text><path d="M101.4878,252.5479 L165.5371,252.5479 L165.5371,260.3472 L155.5371,270.3472 L101.4878,270.3472 L101.4878,252.5479 " fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><rect fill="none" height="1057.6841" style="stroke:#000000;stroke-width:1;" width="1429.0742" x="101.4878" y="252.5479"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.0493" x="116.4878" y="266.6177">alt</text><text fill="#000000" font-family="Verdana" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="107.7979" x="180.5371" y="265.6069">[no transactions]</text><line style="stroke:#000000;stroke-width:1;" x1="224.5679" x2="266.5679" y1="292.1465" y2="292.1465"/><line style="stroke:#000000;stroke-width:1;" x1="266.5679" x2="266.5679" y1="292.1465" y2="305.1465"/><line style="stroke:#000000;stroke-width:1;" x1="225.5679" x2="266.5679" y1="305.1465" y2="305.1465"/><polygon fill="#000000" points="235.5679,301.1465,225.5679,305.1465,235.5679,309.1465,231.5679,305.1465" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="196.8853" x="231.5679" y="287.417">log "No transactions" &amp; return</text><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="101.4878" x2="1530.562" y1="314.1465" y2="314.1465"/><text fill="#000000" font-family="Verdana" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="114.1196" x="106.4878" y="325.2056">[has transactions]</text><polygon fill="#000000" points="674.7568,346.3145,684.7568,350.3145,674.7568,354.3145,678.7568,350.3145" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="224.5679" x2="680.7568" y1="350.3145" y2="350.3145"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="325.1968" x="231.5679" y="345.585">getDailySummariesBetween(firstDate, yesterday)</text><polygon fill="#000000" points="1309.0884,391.9131,1319.0884,395.9131,1309.0884,399.9131,1313.0884,395.9131" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="696.7568" x2="1315.0884" y1="395.9131" y2="395.9131"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="272.0732" x="703.7568" y="375.3843">SELECT * FROM portfolio_daily_summary</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="249.2979" x="703.7568" y="391.1836">WHERE entry_date BETWEEN ? AND ?</text><polygon fill="#000000" points="702.7568,421.7124,692.7568,425.7124,702.7568,429.7124,698.7568,425.7124" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="696.7568" x2="1320.0884" y1="425.7124" y2="425.7124"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="127.0928" x="708.7568" y="420.9829">existing summaries</text><line style="stroke:#000000;stroke-width:1;" x1="224.5679" x2="266.5679" y1="471.311" y2="471.311"/><line style="stroke:#000000;stroke-width:1;" x1="266.5679" x2="266.5679" y1="471.311" y2="484.311"/><line style="stroke:#000000;stroke-width:1;" x1="225.5679" x2="266.5679" y1="484.311" y2="484.311"/><polygon fill="#000000" points="235.5679,480.311,225.5679,484.311,235.5679,488.311,231.5679,484.311" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="159.2627" x="231.5679" y="450.7822">Generate date sequence</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="230.2104" x="231.5679" y="466.5815">(firstTransactionDate to yesterday)</text><line style="stroke:#000000;stroke-width:1;" x1="224.5679" x2="266.5679" y1="514.1104" y2="514.1104"/><line style="stroke:#000000;stroke-width:1;" x1="266.5679" x2="266.5679" y1="514.1104" y2="527.1104"/><line style="stroke:#000000;stroke-width:1;" x1="225.5679" x2="266.5679" y1="527.1104" y2="527.1104"/><polygon fill="#000000" points="235.5679,523.1104,225.5679,527.1104,235.5679,531.1104,231.5679,527.1104" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="154.3115" x="231.5679" y="509.3809">Filter out existing dates</text><path d="M111.4878,542.1104 L175.5371,542.1104 L175.5371,549.9097 L165.5371,559.9097 L111.4878,559.9097 L111.4878,542.1104 " fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><rect fill="none" height="761.1216" style="stroke:#000000;stroke-width:1;" width="1409.0742" x="111.4878" y="542.1104"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.0493" x="126.4878" y="556.1802">alt</text><text fill="#000000" font-family="Verdana" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="138.9287" x="190.5371" y="555.1694">[has dates to process]</text><polygon fill="#000000" points="906.3594,577.709,916.3594,581.709,906.3594,585.709,910.3594,581.709" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="224.5679" x2="912.3594" y1="581.709" y2="581.709"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="268.7471" x="231.5679" y="576.9795">calculateBatchXirrAsync(datesToProcess)</text><polygon fill="#000000" points="1175.9653,607.5083,1185.9653,611.5083,1175.9653,615.5083,1179.9653,611.5083" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="928.3594" x2="1181.9653" y1="611.5083" y2="611.5083"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="179.4482" x="935.3594" y="606.7788">Launch parallel calculations</text><path d="M390.1655,626.5083 L466.5483,626.5083 L466.5483,634.3076 L456.5483,644.3076 L390.1655,644.3076 L390.1655,626.5083 " fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><rect fill="none" height="418.7598" style="stroke:#000000;stroke-width:1;" width="1120.3965" x="390.1655" y="626.5083"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="31.3828" x="405.1655" y="640.5781">loop</text><text fill="#000000" font-family="Verdana" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="222.9165" x="481.5483" y="639.5674">[for each date (in parallel batches)]</text><polygon fill="#000000" points="707.7568,662.1069,697.7568,666.1069,707.7568,670.1069,703.7568,666.1069" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="701.7568" x2="1186.9653" y1="666.1069" y2="666.1069"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="213.021" x="713.7568" y="661.3774">calculateSummaryForDate(date)</text><polygon fill="#000000" points="494.7783,691.9063,484.7783,695.9063,494.7783,699.9063,490.7783,695.9063" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="488.7783" x2="685.7568" y1="695.9063" y2="695.9063"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="178.9785" x="500.7783" y="691.1768">Get transactions up to date</text><line style="stroke:#000000;stroke-width:1;" x1="696.7568" x2="738.7568" y1="725.7056" y2="725.7056"/><line style="stroke:#000000;stroke-width:1;" x1="738.7568" x2="738.7568" y1="725.7056" y2="738.7056"/><line style="stroke:#000000;stroke-width:1;" x1="697.7568" x2="738.7568" y1="738.7056" y2="738.7056"/><polygon fill="#000000" points="707.7568,734.7056,697.7568,738.7056,707.7568,742.7056,703.7568,738.7056" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="177.4805" x="703.7568" y="720.9761">Calculate total value, profit</text><polygon fill="#000000" points="906.3594,764.5049,916.3594,768.5049,906.3594,772.5049,910.3594,768.5049" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="696.7568" x2="912.3594" y1="768.5049" y2="768.5049"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="153.6069" x="703.7568" y="763.7754">Build XIRR transactions</text><polygon fill="#000000" points="906.3594,794.3042,916.3594,798.3042,906.3594,802.3042,910.3594,798.3042" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="696.7568" x2="912.3594" y1="798.3042" y2="798.3042"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="96.7192" x="703.7568" y="793.5747">Calculate XIRR</text><polygon fill="#000000" points="707.7568,824.1035,697.7568,828.1035,707.7568,832.1035,703.7568,828.1035" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="701.7568" x2="917.3594" y1="828.1035" y2="828.1035"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="72.0649" x="713.7568" y="823.374">XIRR value</text><line style="stroke:#000000;stroke-width:1;" x1="696.7568" x2="738.7568" y1="857.9028" y2="857.9028"/><line style="stroke:#000000;stroke-width:1;" x1="738.7568" x2="738.7568" y1="857.9028" y2="870.9028"/><line style="stroke:#000000;stroke-width:1;" x1="697.7568" x2="738.7568" y1="870.9028" y2="870.9028"/><polygon fill="#000000" points="707.7568,866.9028,697.7568,870.9028,707.7568,874.9028,703.7568,870.9028" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="197.6025" x="703.7568" y="853.1733">Create PortfolioDailySummary</text><polygon fill="#000000" points="1309.0884,896.7021,1319.0884,900.7021,1309.0884,904.7021,1313.0884,900.7021" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="696.7568" x2="1315.0884" y1="900.7021" y2="900.7021"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="216.2964" x="703.7568" y="895.9727">Check if summary exists for date</text><path d="M604.7681,915.7021 L668.8174,915.7021 L668.8174,923.5015 L658.8174,933.5015 L604.7681,933.5015 L604.7681,915.7021 " fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><rect fill="none" height="92.7666" style="stroke:#000000;stroke-width:1;" width="776.2627" x="604.7681" y="915.7021"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.0493" x="619.7681" y="929.772">alt</text><text fill="#000000" font-family="Verdana" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="109.8174" x="683.8174" y="928.7612">[summary exists]</text><polygon fill="#000000" points="1309.0884,951.3008,1319.0884,955.3008,1309.0884,959.3008,1313.0884,955.3008" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="696.7568" x2="1315.0884" y1="955.3008" y2="955.3008"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="219.8066" x="703.7568" y="950.5713">UPDATE portfolio_daily_summary</text><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="604.7681" x2="1381.0308" y1="964.3008" y2="964.3008"/><text fill="#000000" font-family="Verdana" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="88.7197" x="609.7681" y="975.3599">[no summary]</text><polygon fill="#000000" points="1309.0884,996.4688,1319.0884,1000.4688,1309.0884,1004.4688,1313.0884,1000.4688" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="696.7568" x2="1315.0884" y1="1000.4688" y2="1000.4688"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="216.6709" x="703.7568" y="995.7393">INSERT portfolio_daily_summary</text><polygon fill="#000000" points="1428.7964,1033.2681,1438.7964,1037.2681,1428.7964,1041.2681,1432.7964,1037.2681" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;" x1="691.7568" x2="1434.7964" y1="1037.2681" y2="1037.2681"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="147.4688" x="698.7568" y="1032.5386">EVICT summary cache</text><polygon fill="#000000" points="939.3594,1085.8667,929.3594,1089.8667,939.3594,1093.8667,935.3594,1089.8667" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="933.3594" x2="1191.9653" y1="1089.8667" y2="1089.8667"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="135.6748" x="945.3594" y="1069.3379">XirrCalculationResult</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="235.606" x="945.3594" y="1085.1372">(processedDates, failures, duration)</text><polygon fill="#000000" points="235.5679,1115.666,225.5679,1119.666,235.5679,1123.666,231.5679,1119.666" style="stroke:#000000;stroke-width:1;"/><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="229.5679" x2="922.3594" y1="1119.666" y2="1119.666"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="36.9814" x="241.5679" y="1114.9365">result</text><line style="stroke:#000000;stroke-width:1;" x1="224.5679" x2="266.5679" y1="1149.4653" y2="1149.4653"/><line style="stroke:#000000;stroke-width:1;" x1="266.5679" x2="266.5679" y1="1149.4653" y2="1162.4653"/><line style="stroke:#000000;stroke-width:1;" x1="225.5679" x2="266.5679" y1="1162.4653" y2="1162.4653"/><polygon fill="#000000" points="235.5679,1158.4653,225.5679,1162.4653,235.5679,1166.4653,231.5679,1162.4653" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="217.3311" x="231.5679" y="1144.7358">Log: "Processed X dates in Y ms"</text><path d="M121.4878,1177.4653 L185.5371,1177.4653 L185.5371,1185.2646 L175.5371,1195.2646 L121.4878,1195.2646 L121.4878,1177.4653 " fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><rect fill="none" height="60.5986" style="stroke:#000000;stroke-width:1;" width="361.9414" x="121.4878" y="1177.4653"/><text fill="#000000" font-family="Verdana" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.0493" x="136.4878" y="1191.5352">alt</text><text fill="#000000" font-family="Verdana" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="84.0737" x="200.5371" y="1190.5244">[has failures]</text><line style="stroke:#000000;stroke-width:1;" x1="224.5679" x2="266.5679" y1="1217.064" y2="1217.064"/><line style="stroke:#000000;stroke-width:1;" x1="266.5679" x2="266.5679" y1="1217.064" y2="1230.064"/><line style="stroke:#000000;stroke-width:1;" x1="225.5679" x2="266.5679" y1="1230.064" y2="1230.064"/><polygon fill="#000000" points="235.5679,1226.064,225.5679,1230.064,235.5679,1234.064,231.5679,1230.064" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="229.8613" x="231.5679" y="1212.3345">Log warnings for failed calculations</text><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="111.4878" x2="1520.562" y1="1246.064" y2="1246.064"/><text fill="#000000" font-family="Verdana" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="94.6602" x="116.4878" y="1257.123">[no new dates]</text><line style="stroke:#000000;stroke-width:1;" x1="224.5679" x2="266.5679" y1="1282.2319" y2="1282.2319"/><line style="stroke:#000000;stroke-width:1;" x1="266.5679" x2="266.5679" y1="1282.2319" y2="1295.2319"/><line style="stroke:#000000;stroke-width:1;" x1="225.5679" x2="266.5679" y1="1295.2319" y2="1295.2319"/><polygon fill="#000000" points="235.5679,1291.2319,225.5679,1295.2319,235.5679,1299.2319,231.5679,1295.2319" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="196.7266" x="231.5679" y="1277.5024">log "No new dates to process"</text><path d="M928,1322.2319 L928,1410.2319 L1221,1410.2319 L1221,1332.2319 L1211,1322.2319 L928,1322.2319 " fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M1211,1322.2319 L1211,1332.2319 L1221,1332.2319 L1211,1322.2319 " fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="269.623" x="934" y="1340.3018">Parallel execution with Kotlin Coroutines:</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="272.2319" x="934" y="1356.1011">- Dispatcher with configurable parallelism</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="209.7583" x="934" y="1371.9004">- Batch processing for efficiency</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="203.4805" x="934" y="1387.6997">- Error handling per calculation</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="228.4014" x="934" y="1403.499">- Returns success/failure summary</text><path d="M696,1421.2285 L696,1525.2285 L1087,1525.2285 L1087,1431.2285 L1077,1421.2285 L696,1421.2285 " fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M1077,1421.2285 L1077,1431.2285 L1087,1431.2285 L1077,1421.2285 " fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="114.5625" x="702" y="1439.2983">XIRR Calculation:</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="370.3477" x="702" y="1455.0977">1. Collect all cash flows (buy = negative, sell = positive)</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="309.5815" x="702" y="1470.897">2. Add current portfolio value as final cash flow</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="315.0215" x="702" y="1486.6963">3. Calculate IRR using Newton-Raphson method</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="147.8623" x="702" y="1502.4956">4. Annualize the result</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="329.2656" x="702" y="1518.2949">5. Dampen extreme values (&gt;1000% or &lt;-100%)</text><path d="M1326,1536.0244 L1326,1624.0244 L1708,1624.0244 L1708,1546.0244 L1698,1536.0244 L1326,1536.0244 " fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><path d="M1698,1536.0244 L1698,1546.0244 L1708,1546.0244 L1698,1536.0244 " fill="#FFFFFF" style="stroke:#000000;stroke-width:1;"/><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="161.1353" x="1332" y="1554.0942">Idempotency via upsert:</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="226.77" x="1332" y="1569.8936">- Check if summary exists for date</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="201.9824" x="1332" y="1585.6929">- Update if exists, insert if new</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="361.2832" x="1332" y="1601.4922">- UNIQUE constraint on entry_date prevents duplicates</text><text fill="#000000" font-family="Verdana" font-size="13" lengthAdjust="spacing" textLength="206.2036" x="1332" y="1617.2915">- Safe to run job multiple times</text><!--SRC=[ZLVRSjis47tdLsmrauxTYLsdQVkWQPBADfswTHHNaXjdnZCUY5oAQ2601K39wjTt0Tv0NUBemQR0nS7ksTs3rJSsnoL28HYNaULM8DnVJoPmmKHI2cQvad0br1fEu99niO5RfMsc15SmBPTBfZTHL31jUS8B9YqCfacEQIbG3u0PCCstlf67Qf7kkTQ_gxdVyBUQzqrdcad34kV85FMA9-Zjx9DyDAjaw-pAez3EL4kxja60eNr2otkCbLQbvH8fV2KgmsR9R8TcsPoP2YtT2cQ2AJV4BR5IdqPFKUJ2Mp6B0Ltj4voyTQGCuTU6sHIivei5wWTvbFgSC0i_3r-VmUZ3SOVbc8peZmEesHh20kr8Y81JSnHiQKYj_xkTAPqyZM_YYnby1rUJZn-WQDBsQ3kO1_bnSXbFuFmp1AkFAQ6-19v6ARaH-X4OcIZ57GyY9Yn8rRS3-jG1UKQ4Mi1Wt3SQmBUWqPPQHYWCGkvgvG18K1kU6L-LLGrnDETeruZoAEFQq2iNo0QDHPsopR67wT8M59bx4Nn_ZaEVmCTwmuFyz5iyYG6bfTsEF3YFPv_YU0plO3I-X7SUlYQpvpu-SKFLkAXNoV_A5FSwkKFbUvIedPK_rE2_9Se47-heWtgvz5bIsrI4M5TSq2kWxkYySh2cEjPbrcN5BpceGgi4JULlWDLquj0_kLR5SsQJtAd5o6naSkGHPkgssd_S0hGXjytSlcfM_05j1m_XXfKooO6QbGc1eZsoBPa-RjVxxKkXL06Pqa2CvnMDHrnsY7FdEmPUUdTQe9rwR8EkHUrAQSUz3xeFSZZ3pMUh7jikV8-srnnG5YuXxeWlxU_vsUYegmhB1AoOAAbLAAaPjrzqeqlmUSb5MjqxExtwxERE0GVGfxVDzhRN_YplQlJraMfqfxJNLY0Nco-1kFQ_o37v1tZMlAiwm_Y2yNJtCqejqZVilJvmnjtjvMWM7zAM7eANHfBNVUyEe5-Ff_5azdNeCdqcyTG9GuZ_kYP5REAihi9mrm7jsdjAs4Yzwd1g4Lpr4pIbiAHhjUXWwfhAl8ICeYcrUqfBxKsx9WiSsTVvlIhp2gZzANltxoXIg9mtQZ64mMtZ6jpN8aawyXcMPj3jQaIqSRj7t1Oah9cM9C9LjRaT1BrNu1obONb8NDVAlG-wkNvRgq3C1r63vzCKCE374gdeYOQOt8BAEb80RXkvn2TCIZzzhhdDuGzb1R5mqKas6TD8oatXTLLNPecI6LzG0kSqnpRIoytI6_lRet7GNKfUhRECfZEwx3RU9jQQ5dCcK-4i2W8EcF8c4pzTkCaoSK3VrobeUua21XVVTfJz6juUibqyhqufGF8uiPHVTmUP73AQlGqSpSiDl26c5sIy8darI0Plg1iDTmkkLdyuXL5AYIsrflcXQzHAvjoqcN790bZQy_eqa4_dKUc96UFQAdaoOKLkA0DBjBbobV4Z7I5boGJ_Z-G-nwxGVpgbdmVB0YKbpchtYyAVIfw_VNLsTlO2YDLVJkZnnV51WcXO1hXESLdGCYK4LfpHZMHGsohRpugeCxeh_DrBLjLR6Z-bWt0hLAcLpVZwpxlOLOkX-uOJMnHbC7GL6bVqbMQKiX0ygJlW1AOiyyEFBgNlX2K5pmigDSkNPD86zZy0]--></g></svg>